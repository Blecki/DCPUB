// A test of language features

static vram_ptr = 0x8000;

function print(a)
{
	while (*a != 0)
	{
		if (*a == 10)
		{
			a = a + 1;
			//advance vram to next line
			vram_ptr = vram_ptr + 32;
			vram_ptr = vram_ptr - (vram_ptr % 32);
		}
		else
		{ 
			*vram_ptr = 0x7000 + *a;
			vram_ptr = vram_ptr + 1;
			a = a + 1;
		}
	}
}

function fibonacci(n)
{
	if (2 > n) return n;
	return fibonacci(n-1) + fibonacci(n-2);
}

if (fibonacci(6) == 8)
	print({"Fibonacci passed", 10, 0});
else
	print({"Fibonacci failed", 10, 0});
	
//This test function spills onto the stack.
function spill(a,b,c,d, e,f,g,h)
{
	return a + (b * c) - d * e + f / g - h + b / c;
}

if (spill(1,2,3,4,5,6,7,8) == -21)
	print({"Spill passed", 10, 0});
else
	print({"Spill failed", 10, 0});
lse
	print(&"Spill failed" 10 0);

